{% extends "base.html" %}

{% load humanize %}
{% load static %}

{% block head_title %}
  Checkout
{% endblock head_title %}

{% block content %}
  <link href="{% static 'css/stripe_form.css' %}" rel="stylesheet"/>


  {#  <!--Main layout-->#}
  {#  <main class="mt-2 pt-4">#}
  {#    <div class="container wow fadeIn">#}
  {##}
  {#      <!-- Heading -->#}
  {#      <h2 class="h2 text-center">Checkout</h2>#}
  {#      <div class="text-center mb-2">#}
  {#        <a href="{% url 'product:product_list' %}" class="btn btn-outline-primary btn-lg mb-2">#}
  {#          Continue Shopping#}
  {#          <i class="fas fa-shopping-basket ml-2"></i>#}
  {#        </a>#}
  {#        <a href="{% url 'shopping:cart' %}" class="btn btn-outline-primary btn-lg mb-2">#}
  {#          Return to Cart#}
  {#          <i class="fas fa-shopping-cart ml-2"></i>#}
  {#        </a>#}
  {#      </div>#}
  {##}
  {#      <!--Grid row-->#}
  {#      <div class="row">#}
  {##}
  {#        <!--Grid column-->#}
  {#        <div class="col-md-8 mb-4">#}
  {##}
  {#          <!--Card-->#}
  {#          <div class="card">#}
  {##}
  {#            <!--Card content-->#}
  {#            <form class="card-body">#}
  {##}
  {#              <!--Grid row-->#}
  {#              <div class="row">#}
  {##}
  {#                <!--Grid column-->#}
  {#                <div class="col-md-6 mb-2">#}
  {##}
  {#                  <!--firstName-->#}
  {#                  <div class="md-form ">#}
  {#                    <input type="text" id="firstName" class="form-control">#}
  {#                    <label for="firstName" class="">First name</label>#}
  {#                  </div>#}
  {##}
  {#                </div>#}
  {#                <!--Grid column-->#}
  {##}
  {#                <!--Grid column-->#}
  {#                <div class="col-md-6 mb-2">#}
  {##}
  {#                  <!--lastName-->#}
  {#                  <div class="md-form">#}
  {#                    <input type="text" id="lastName" class="form-control">#}
  {#                    <label for="lastName" class="">Last name</label>#}
  {#                  </div>#}
  {##}
  {#                </div>#}
  {#                <!--Grid column-->#}
  {##}
  {#              </div>#}
  {#              <!--Grid row-->#}
  {##}
  {#              <!--address-->#}
  {#              <div class="md-form mb-5">#}
  {#                <input type="text" id="address" class="form-control" placeholder="123 Main St">#}
  {#                <label for="address" class="">Address</label>#}
  {#              </div>#}
  {##}
  {#              <!--address-2-->#}
  {#              <div class="md-form mb-5">#}
  {#                <input type="text" id="address-2" class="form-control" placeholder="Apartment or suite">#}
  {#                <label for="address-2" class="">Address 2 (optional)</label>#}
  {#              </div>#}
  {##}
  {#              <!--Grid row-->#}
  {#              <div class="row">#}
  {##}
  {#                <!--Grid column-->#}
  {#                <div class="col-lg-4 col-md-12 mb-4">#}
  {#                  <!--city-->#}
  {#                  <div class="md-form mb-5">#}
  {#                    <input type="text" id="city" class="form-control" placeholder="Pittsburgh">#}
  {#                    <label for="city" class="">City</label>#}
  {#                  </div>#}
  {#                </div>#}
  {#                <!--Grid column-->#}
  {##}
  {#                <!--Grid column-->#}
  {#                <div class="col-lg-4 col-md-6 mb-4">#}
  {##}
  {#                  <label for="state">State</label>#}
  {#                  <select class="custom-select d-block w-100" id="state" required>#}
  {#                    <option value="">Choose...</option>#}
  {#                    <option>California</option>#}
  {#                  </select>#}
  {#                  <div class="invalid-feedback">#}
  {#                    Please provide a valid state.#}
  {#                  </div>#}
  {##}
  {#                </div>#}
  {#                <!--Grid column-->#}
  {##}
  {#                <!--Grid column-->#}
  {#                <div class="col-lg-4 col-md-6 mb-4">#}
  {##}
  {#                  <label for="zip">Zip</label>#}
  {#                  <input type="text" class="form-control" id="zip" placeholder="" required>#}
  {#                  <div class="invalid-feedback">#}
  {#                    Zip code required.#}
  {#                  </div>#}
  {##}
  {#                </div>#}
  {#                <!--Grid column-->#}
  {##}
  {#              </div>#}
  {#              <!--Grid row-->#}
  {##}
  {#              <hr>#}
  {##}
  {#              <div class="custom-control custom-checkbox">#}
  {#                <input type="checkbox" class="custom-control-input" id="same-address">#}
  {#                <label class="custom-control-label" for="same-address">Shipping address is the same as my billing#}
  {#                  address</label>#}
  {#              </div>#}
  {#              <div class="custom-control custom-checkbox">#}
  {#                <input type="checkbox" class="custom-control-input" id="save-info">#}
  {#                <label class="custom-control-label" for="save-info">Save this information for next time</label>#}
  {#              </div>#}
  {##}
  {#              <hr>#}
  {##}
  {#              <div class="d-block my-3">#}
  {#                <div class="custom-control custom-radio">#}
  {#                  <input id="credit" name="paymentMethod" type="radio" class="custom-control-input" checked required>#}
  {#                  <label class="custom-control-label" for="credit">Credit card</label>#}
  {#                </div>#}
  {#                <div class="custom-control custom-radio">#}
  {#                  <input id="debit" name="paymentMethod" type="radio" class="custom-control-input" required>#}
  {#                  <label class="custom-control-label" for="debit">Debit card</label>#}
  {#                </div>#}
  {#                <div class="custom-control custom-radio">#}
  {#                  <input id="paypal" name="paymentMethod" type="radio" class="custom-control-input" required>#}
  {#                  <label class="custom-control-label" for="paypal">Paypal</label>#}
  {#                </div>#}
  {#              </div>#}
  {#              <div class="row">#}
  {#                <div class="col-md-6 mb-3">#}
  {#                  <label for="cc-name">Name on card</label>#}
  {#                  <input type="text" class="form-control" id="cc-name" placeholder="" required>#}
  {#                  <small class="text-muted">Full name as displayed on card</small>#}
  {#                  <div class="invalid-feedback">#}
  {#                    Name on card is required#}
  {#                  </div>#}
  {#                </div>#}
  {#                <div class="col-md-6 mb-3">#}
  {#                  <label for="cc-number">Credit card number</label>#}
  {#                  <input type="text" class="form-control" id="cc-number" placeholder="" required>#}
  {#                  <div class="invalid-feedback">#}
  {#                    Credit card number is required#}
  {#                  </div>#}
  {#                </div>#}
  {#              </div>#}
  {#              <div class="row">#}
  {#                <div class="col-md-3 mb-3">#}
  {#                  <label for="cc-expiration">Expiration</label>#}
  {#                  <input type="text" class="form-control" id="cc-expiration" placeholder="" required>#}
  {#                  <div class="invalid-feedback">#}
  {#                    Expiration date required#}
  {#                  </div>#}
  {#                </div>#}
  {#                <div class="col-md-3 mb-3">#}
  {#                  <label for="cc-expiration">CVV</label>#}
  {#                  <input type="text" class="form-control" id="cc-cvv" placeholder="" required>#}
  {#                  <div class="invalid-feedback">#}
  {#                    Security code required#}
  {#                  </div>#}
  {#                </div>#}
  {#              </div>#}
  {#              <hr class="mb-4">#}
  {#              <button class="btn btn-primary btn-lg btn-block" type="submit">Continue to checkout</button>#}
  {##}
  {#            </form>#}
  {##}
  {#          </div>#}
  {#          <!--/.Card-->#}
  {##}
  {#        </div>#}
  {#        <!--Grid column-->#}
  {##}
  {#        <!--Grid column-->#}
  {#        <div class="col-md-4 mb-4">#}
  {##}
  {#          <!-- Heading -->#}
  {#          <h4 class="d-flex justify-content-between align-items-center mb-3">#}
  {#            <span class="text-muted">Your cart</span>#}
  {#            <span class="badge badge-secondary badge-pill">3</span>#}
  {#          </h4>#}
  {##}
  {#          <!-- Cart -->#}
  {#          <ul class="list-group mb-3 z-depth-2">#}
  {##}
  {##}
  {#            {% for item in cart.items.all %}#}
  {#              <li class="list-group-item d-flex justify-content-between lh-condensed">#}
  {#                <div>#}
  {#                  <h6 class="my-0">{{ item.product.name }}</h6>#}
  {#                  <small class="text-muted">Frame color or contact info</small>#}
  {#                </div>#}
  {#                <span class="text-muted">$ {{ item.product.final_price|intcomma|floatformat:-2 }}</span>#}
  {#              </li>#}
  {##}
  {#            {% empty %}#}
  {#              <li class="list-group-item d-flex justify-content-between lh-condensed">#}
  {#                <h6 class="my-0 text-center">There is nothing in your cart</h6>#}
  {#              </li>#}
  {##}
  {##}
  {#            {% endfor %}#}
  {##}
  {##}
  {#            <li class="list-group-item d-flex justify-content-between bg-light">#}
  {#              <div class="text-success">#}
  {#                <h6 class="my-0">Promo code</h6>#}
  {#                <small>EXAMPLECODE</small>#}
  {#              </div>#}
  {#              <span class="text-success">-$5</span>#}
  {#            </li>#}
  {#            <li class="list-group-item d-flex justify-content-between">#}
  {#              <span>Total (USD)</span>#}
  {#              <strong>$20</strong>#}
  {#            </li>#}
  {#          </ul>#}
  {#          <!-- Cart -->#}
  {##}
  {#          <!-- Promo code -->#}
  {#          <form class="card p-2">#}
  {#            <div class="input-group">#}
  {#              <input type="text" class="form-control" placeholder="Promo code" aria-label="Recipient's username"#}
  {#                     aria-describedby="basic-addon2">#}
  {#              <div class="input-group-append">#}
  {#                <button class="btn btn-secondary btn-md waves-effect m-0" type="button">Redeem</button>#}
  {#              </div>#}
  {#            </div>#}
  {#          </form>#}
  {#          <!-- Promo code -->#}
  {##}
  {#        </div>#}
  {#        <!--Grid column-->#}
  {##}
  {#      </div>#}
  {#      <!--Grid row-->#}
  {##}
  {#    </div>#}
  {#  </main>#}
  {#  <!--Main layout-->#}


  <table class="table table-hover table-bordered text-center">
    <tr class="text-center">
      <th>NO.</th>
      <th>Product Name</th>
      <th>Price</th>
    </tr>
    {% for item in cart.items.all %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td class="text-left">
          {{ item.product.name }}
          {% if item.product.label == 'S' %}
            <span class="badge badge-pill danger-color ml-5">{{ item.product.get_label_display }}</span>
          {% endif %}
        </td>
        <td>
          {% if item.product.label == 'S' %}
            <span class="mr-2"><del>$ {{ item.product.price|intcomma }}</del></span>
            <span>$ {{ item.product.final_price|intcomma|floatformat:-2 }}</span>
          {% else %}
            <span>$ {{ item.product.final_price|intcomma|floatformat:-2 }}</span>
          {% endif %}
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="3">
          There is nothing in your cart
        </td>
      </tr>
    {% endfor %}
    {% if cart.get_total %}
      <tr>
        <td colspan="2">
          <strong class="pull-right">Order total: </strong>
        </td>
        <td colspan="1">
          <strong>$ {{ cart.get_total|intcomma|floatformat:-2 }}</strong>
        </td>
      </tr>
    {% endif %}
  </table>

  <div class="wrapper">
    <script src="https://js.stripe.com/v3/"></script>

    <form action="." method="post" id="payment-form">
      {% csrf_token %}
      <div class="stripe-form-row">
        <label for="card-element" class="stripe-label">
          Credit or debit card
        </label>
        <div id="card-element" class="StripeElement StripeElement--empty">
          <div class="__PrivateStripeElement"
               style="margin: 0px !important; padding: 0px !important; border: none !important; display: block !important; background: transparent !important; position: relative !important; opacity: 1 !important;">
            <iframe frameborder="0" allowtransparency="true" scrolling="no" name="__privateStripeFrame5"
                    allowpaymentrequest="true"
                    src="https://js.stripe.com/v3/elements-inner-card-fbfeb5b62d598125b16ab6addef894d6.html#style[base][color]=%2332325d&amp;style[base][fontFamily]=%22Helvetica+Neue%22%2C+Helvetica%2C+sans-serif&amp;style[base][fontSmoothing]=antialiased&amp;style[base][fontSize]=16px&amp;style[base][::placeholder][color]=%23aab7c4&amp;style[invalid][color]=%23fa755a&amp;style[invalid][iconColor]=%23fa755a&amp;componentName=card&amp;wait=false&amp;rtl=false&amp;keyMode=test&amp;apiKey=pk_test_1RE9q7BFBBM1iEU9MWkg3cZK00nNu0ayiI&amp;origin=https%3A%2F%2Fstripe.com&amp;referrer=https%3A%2F%2Fstripe.com%2Fdocs%2Fstripe-js&amp;controllerId=__privateStripeController1"
                    title="Secure payment input frame"
                    style="border: none !important; margin: 0px !important; padding: 0px !important; width: 1px !important; min-width: 100% !important; overflow: hidden !important; display: block !important; user-select: none !important; height: 19.2px;"></iframe>
            <input class="__PrivateStripeElement-input" aria-hidden="true" aria-label=" " autocomplete="false"
                   maxlength="1"
                   style="border: none !important; display: block !important; position: absolute !important; height: 1px !important; top: 0px !important; left: 0px !important; padding: 0px !important; margin: 0px !important; width: 100% !important; opacity: 0 !important; background: transparent !important; pointer-events: none !important; font-size: 16px !important;">
          </div>
        </div>

        <!-- Used to display form errors. -->
        <div id="card-errors" role="alert"></div>
      </div>

      <button>Submit Payment</button>
    </form>
  </div>
  <script src="{% static 'js/stripe_form.js' %}"></script>

{% endblock content %}





